## Локализация интерфейса

### Поддерживаемые языки
- Русский (`ru`)
- Английский (`en`) — используется по умолчанию

Языки конфигурируются в `config/app.php` через массив `supported_locales`. Подписи отображаются в выпадающем списке выбора языка.

### Переводы
- Ключи JSON: `lang/ru.json`, `lang/en.json` — основная масса пользовательских сообщений и подписей.
- Структурированные файлы: `lang/{locale}/users.php`, `lang/{locale}/logs.php`, `lang/{locale}/settings.php` — доменные блоки, добавленные ранее.

При добавлении новой строки в Blade/контроллер необходимо вызвать `__('...')`. Строка автоматически появится в генераторе `php scripts/build_locale_json.php`, после чего её перевод следует дополнить вручную.

### Переключение языка
- Маршрут: `GET /locale/{locale}` (`LocaleController`). Принимает только локали из `config('app.supported_locales')`, сохраняет выбор в сессии и делает безопасный редирект на предыдущую страницу.
- Middleware `SetLocale` подключён к группе `web`. Он читает локаль из сессии, устанавливает `app()->setLocale()` и синхронизирует `Carbon`/`setlocale`.

### UI
- В административном navbar и в гостевом layout (`resources/views/layouts`) добавлен выпадающий список языков с отображением текущего варианта.
- После переключения язык интерфейса меняется без перезагрузки сессии пользователя; пользовательские настройки не трогаются.

### Тестирование
- Автотесты (`tests/Feature/LocaleSwitchTest.php`) проверяют смену локали и корректность отображения переводов.
- Обновлены существующие тесты, чтобы проверять сообщения как на русском, так и на английском.

### Расширение
1. Добавьте локаль в `config/app.php`.
2. Сгенерируйте JSON через `php scripts/build_locale_json.php`.
3. Переведите строки в `lang/{new_locale}.json` и доменные файлы.
4. При необходимости добавьте пользовательское имя локали в словарь `supported_locales`.

После добавления очистите кеш конфигурации/переводов (`php artisan config:clear`, `php artisan cache:clear`) перед деплоем.  
На shared-хостинге сессия хранится в файловом драйвере, дополнительных сервисов не требуется.

